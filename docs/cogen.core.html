<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">


<!-- remove old header -->


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>cogen API Reference Documentation
        - Module: core</title><meta name="MSSmartTagsPreventParsing" content="true" /><meta http-equiv="imagetoolbar" content="no" /><link href="css/default.css" rel="stylesheet" type="text/css" /><link href="css/pygments.css" rel="stylesheet" type="text/css" />
    <!-- <link rel="shortcut icon" href="/images/favicon.ico" type="image/vnd.microsoft.icon"/> -->
    <link rel="stylesheet" href="css/apydia.css" type="text/css" />
    <script src="js/jquery-1.2.1.pack.js" type="text/javascript"></script>
    <script src="js/apydia.js" type="text/javascript"></script>
	<link rel="icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
    <div id="page">
        <div id="browser">
            <div class="browser-section">
                <h2>Module Index</h2>
                <ul>
                    <li>
                        <a href="cogen.html">cogen</a>
                    </li><li>
                        <a href="cogen.common.html">cogen.common</a>
                    </li><li class="active">
                        <a href="cogen.core.html">cogen.core</a>
                    </li><li>
                        <a href="cogen.core.coroutines.html">cogen.core.coroutines</a>
                    </li><li>
                        <a href="cogen.core.events.html">cogen.core.events</a>
                    </li><li>
                        <a href="cogen.core.pubsub.html">cogen.core.pubsub</a>
                    </li><li>
                        <a href="cogen.core.queue.html">cogen.core.queue</a>
                    </li><li>
                        <a href="cogen.core.reactors.html">cogen.core.reactors</a>
                    </li><li>
                        <a href="cogen.core.schedulers.html">cogen.core.schedulers</a>
                    </li><li>
                        <a href="cogen.core.sockets.html">cogen.core.sockets</a>
                    </li><li>
                        <a href="cogen.core.util.html">cogen.core.util</a>
                    </li><li>
                        <a href="cogen.web.html">cogen.web</a>
                    </li><li>
                        <a href="cogen.web.async.html">cogen.web.async</a>
                    </li><li>
                        <a href="cogen.web.wsgi.html">cogen.web.wsgi</a>
                    </li>
                </ul>
            </div>
            <div class="browser-section">
                <h2>Submodules</h2>
                <ul>
                    <li>
                        <a href="cogen.core.coroutines.html">coroutines</a>
                    </li><li>
                        <a href="cogen.core.events.html">events</a>
                    </li><li>
                        <a href="cogen.core.pubsub.html">pubsub</a>
                    </li><li>
                        <a href="cogen.core.queue.html">queue</a>
                    </li><li>
                        <a href="cogen.core.reactors.html">reactors</a>
                    </li><li>
                        <a href="cogen.core.schedulers.html">schedulers</a>
                    </li><li>
                        <a href="cogen.core.sockets.html">sockets</a>
                    </li><li>
                        <a href="cogen.core.util.html">util</a>
                    </li>
                </ul>
            </div>
        </div>
        <div id="content">
    <h1>Module:
        cogen.core
    </h1>
    <div class="docstring plain">This module holds the essential stuff.<br /><br />Programming with this library should be straghtforward. A coroutine is just
a generator wrapped in a operation handling class:<br /><br /><pre class="codeblock python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python" name="code">
@coroutine
def mycoro(bla):
    yield &lt;operation&gt;
    yield &lt;operation&gt;
</pre>
<blockquote></blockquote><ul><li> the <code name="code" class="python">operation</code> instructs the scheduler what to do with the </li></ul><blockquote>coroutine: suspend it till someting happens, add another coro in the scheduler, raise a event and so on.</blockquote><ul><li> the <code name="code" class="python">operations</code> are split up in 2 modules: events and sockets<ul><li> the <code name="code" class="python">operations</code> from sockets are related to network, like reading and </li></ul></li></ul><blockquote>writing, and these are done asynchronously but your code in the coroutine will see them as a regular synchronous or blocking call.</blockquote><ul><li> the <code name="code" class="python">operations</code> from events are related to signals and </li></ul><blockquote>coroutine/scheduler management.</blockquote><ul><li> if a <code name="code" class="python">operation</code> has a result associated then the yield will return that </li></ul><blockquote>result (eg. a string or a (connection, address) tuple) otherwise it will return the operation instance.</blockquote>
Typical example:<br /><br /><pre class="codeblock python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python python" name="code">
import sys, os
from cogen.common import *

@coroutine
def server():
    srv = sockets.Socket()
    srv.setblocking(0)
    srv.bind(('localhost',777))
    srv.listen(10)
    while 1:
        print "Listening..."
        conn, addr = yield sockets.Accept(srv)
        print "Connection from %s:%s" % addr
        m.add(handler, conn, addr)
        
@coroutine
def handler(sock, addr):
    yield sockets.Write(sock, "WELCOME TO ECHO SERVER !\r\n")
    while 1:
        line = yield sockets.ReadLine(sock, 8192)
        if line.strip() == 'exit':
            yield sockets.Write(sock, "GOOD BYE")
            sock.close()
            return
            
        yield sockets.Write(sock, line)
        
m = Scheduler()
m.add(server)
m.run()
</pre></div>
    <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\__init__.py#L1">View source</a>
    </li>
</ul>
    <div>
        <h2>Modules</h2>
            <h3>
                <a href="cogen.core.coroutines.html">coroutines</a>
            </h3>
            <div class="docstring plain">Coroutine related boilerplate and wrappers.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.coroutines.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\coroutines.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.events.html">events</a>
            </h3>
            <div class="docstring plain">Base events (coroutine operations) and coroutine exceptions.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.events.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\events.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.pubsub.html">pubsub</a>
            </h3>
            <div class="docstring plain"></div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.pubsub.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\pubsub.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.queue.html">queue</a>
            </h3>
            <div class="docstring plain">Port of Queue.Queue from the python standard library.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.queue.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\queue.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.reactors.html">reactors</a>
            </h3>
            <div class="docstring plain">Network polling code.<br /><br />The reactor works in tandem with the socket operations.
Here's the basic workflow:<br /><br /><ul><li> the coroutine yields a operation</li><li> the scheduler runs that operation (the [Docs_CogenCoreEventsOperation#process process] method)</li></ul><blockquote>Note: all the socket operations share the same [Docs_CogenCoreSocketsSocketoperation#process process] method</blockquote><ul><li> if run_first is False then the operation is added in the reactor for </li></ul><blockquote>polling (with the exception that if we have data in out internal buffersthe operation is runned first)</blockquote><ul><li> if run_first is set (it's default) in the operation then in process </li></ul><blockquote>method the reactor's [Docs_CogenCoreReactorsReactorbase#run_or_add run_or_add] is called with the operation and coroutine</blockquote>
<blockquote></blockquote>Note: run_first is a optimization hack really, first it tries to run the
operation (this asumes the sockets are usualy ready) and if it raises any
exceptions like EAGAIN, EWOULDBLOCK etc it adds that operation for polling
(via select, epoll, kqueue etc) then the run method will be called only when
select, epoll, kqueue says that the socket is ready.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.reactors.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\reactors.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.schedulers.html">schedulers</a>
            </h3>
            <div class="docstring plain">Scheduling framework.<br /><br />The scheduler handles the timeouts, run the operations and does very basic
management of coroutines. Most of the heavy logic is in each operation class.
See: <a href="Docs_CogenCoreEvents.html">events</a> and <a href="Docs_CogenCoreSockets.html">sockets</a>
Most of those operations work with attributes we set in the scheduler.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.schedulers.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\schedulers.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.sockets.html">sockets</a>
            </h3>
            <div class="docstring plain">Socket-only coroutine operations and <code name="code" class="python">Socket</code> wrapper.
Really - the only thing you need to know for most stuff is
the <a href="Docs_CogenCoreSocketsSocket.html">Socket</a> class.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.sockets.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\sockets.py#L1">View source</a>
    </li>
</ul>
            <h3>
                <a href="cogen.core.util.html">util</a>
            </h3>
            <div class="docstring plain">Mischelaneous or common.</div>
            <ul class="link-bar">
    <li class="top"><a href="#header">Top</a></li>
    <li>
        <a href="cogen.core.util.html">Details</a>
    </li>
    <li class="link-to-sourcecode">
        <a href="http://cogen.googlecode.com/svn/trunk/cogen\cogen\core\util.py#L1">View source</a>
    </li>
</ul>
    </div>
        </div>
        <div id="footer">
            Generated with <a href="http://apydia.ematia.de/" class="extern">
            Apydia 0.0.3</a>
        </div>
    </div>
</body>
</html>